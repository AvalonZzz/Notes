## Redux Flow

![redux-flow](D:\Notes\react\imgs\redux-flow.png)

## redux使用

1. 安装redux

```bash
npm i redux 
```

2. 创建store对象

```js
// 1. 引入redux
// 2. createStore(reducer)
import { createStore } from 'redux';
const reducer = (
  prevState = {
    show: true,
  },
  action
) => {
  const newState = { ...prevState };
  switch (action.type) {
    case 'hide-tabbar':
      newState.show = false;
      return newState;
    case 'show-tabbar':
      newState.show = true;
      return newState;
    default:
      return prevState;
  }
};
const store = createStore(reducer);
export default store;

// App.js中订阅store
export default class App extends Component {
  state = {
    isShow: true,
  };
  componentDidMount() {
    store.subscribe(() => {
      console.log('app中订阅', store.getState());
      const state = store.getState();
      this.setState({
        isShow: state.show,
      });
    });
  }
  render() {
    return (
      <div>
        <Router>{this.state.isShow && <Tabbar></Tabbar>}</Router>
      </div>
    );
  }
}
// Detail.js中去dispatch修改通知
export default function Detail(props) {
  useEffect(() => {
    store.dispatch({
      type: 'hide-tabbar',
    });
    return () => {
      store.dispatch({
        type: 'show-tabbar',
      });
    };
  }, []);

  return <div>Detail</div>;
}
```

